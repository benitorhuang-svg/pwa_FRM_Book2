{
  "content": "### 3.8 馬可夫鏈蒙地卡羅 (MCMC) 抽樣：破解高維複雜分佈\n馬可夫鏈蒙地卡羅 (MCMC) 是處理非標準、非解析統計分佈的頂級技術。當我們無法直接從目標分佈 $P(x)$ 抽樣時，我們構造一個馬可夫鏈，使其穩態分佈（Stationary Distribution）恰好為 $P(x)$。這在貝葉斯風險建模與隱含參數估計中具有統治地位。\n\n#### 技術核心：Metropolis-Hastings 演算法\nMCMC 的核心在於「接受-拒絕」邏輯。給定當前狀態 $x_t$ 與提議分佈 (Proposal Distribution) $g(x'|x_t)$，接受新狀態 $x'$ 的機率為：\n\n$$\n  A(x', x_t) = \\min\\left(1, \\frac{P(x')g(x_t|x')}{P(x_t)g(x'|x_t)}\right)\n$$\n\n#### 專家決策矩陣：MCMC 抽樣的性能權衡\n資深從業人員必須識別算法在收斂性與效率之間的衝突：\n\n| 觀測指標 | 理想狀態 | 故障特徵 (Bad Convergence) |\n| :--- | :--- | :--- |\n| **接受率 (Acceptance Rate)** | 20% - 40% 為佳 | 過高（移動太細碎）或過低（原地踏步） |\n| **燃燒期 (Burn-in)** | 樣本迅速進入高機率密度區域 | 長時間徘徊於低機率區域，初始點依賴強 |\n| **自相關性** | 樣本間具備獨立性 | 樣本高度相關 (Sticky)，無法完整覆蓋狀態空間 |\n| **跡線圖 (Trace Plot)** | 呈現「毛毛蟲」狀隨機震盪 | 呈現顯著趨勢或階梯狀跳動 |\n\n> [!IMPORTANT]\n> 在 **Python** 定義 MCMC 抽樣器時（見 `B2_Ch3_10.py`），資深分析師會同時執行多條獨立的鏈 (Parallel Chains) 並計算 Gelman-Rubin 指標 ($R$-hat)。若 $R$-hat 顯著大於 1.1，代表模擬尚未收斂，絕對禁止提取樣本進行後續的 VaR 或預期損失計算。\n\n#### 3.8 資深從業人員行動清單 (Action Items)\n啟動 MCMC 模擬前，必須落實：\n- **燃燒期過濾**：捨棄初始 10% - 20% 的样本點，消除隨機初始化的干擾。\n- **變量稀釋 (Thinning)**：若樣本自相關度過高，每隔 $k$ 個點取一個樣本以提升獨立性。\n- **提議分佈校準**：針對不同資產類別動態調整提議分布的方差 $\\sigma_{pro}$，確保接受率處於甜點位 (Sweet Spot)。\n\n#### 核心技術結論\nMCMC 讓「無法解析」變成了「可以模擬」。它將高山峻嶺般的複雜分佈轉化為一步步踏實的隨機漫步，是現代高級定價與風險計量模型的數學動能引擎。"
}