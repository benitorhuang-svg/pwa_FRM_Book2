{"content":"### 3.5 具有相關性的股價模擬：Cholesky 分解技術\n在現代投資組合風險管理中，資產間的聯動性（Correlation）是決定系統性風險的關鍵。我們不能獨立模擬每一隻股票，而必須生成具有特定相關結構的多維路徑。**Cholesky 分解** 是實現這一目標的標準線性代數工具。\n\n#### 技術核心：從獨立到相關\n假設我們有獨立標準正態隨機向量 $\\mathbf{\\epsilon} \\sim N(0, \\mathbf{I})$ 與目標相關係數矩陣 $\\mathbf{R}$。我們的目標是找到一個矩陣 $\\mathbf{L}$，使得 $\\mathbf{X} = \\mathbf{L} \\mathbf{\\epsilon}$ 的相關結構恰好為 $\\mathbf{R}$：\n\n$$\n\n\\begin{aligned}\n  \\mathbf{R} &= \\text{Corr}(\\mathbf{X}) = E[(\\mathbf{L}\\mathbf{\\epsilon})(\\mathbf{L}\\mathbf{\\epsilon})^T] \\\n  \\mathbf{R} &= \\mathbf{L} E[\\mathbf{\\epsilon}\\mathbf{\\epsilon}^T] \\mathbf{L}^T = \\mathbf{L} \\mathbf{I} \\mathbf{L}^T \\\n  \\mathbf{R} &= \\mathbf{L} \\mathbf{L}^T\n\\end{aligned}\n$$\n\n#### 專家決策矩陣：相關性矩陣的數值特徵\n資深計量人員必須識別 $\\mathbf{R}$ 的數學邊界：\n\n| 特徵指標 | 專業要求 | 失敗後果 |\n| :--- | :--- | :--- |\n| **半正定性 (PSD)** | 矩陣所有特徵值必須 $\\ge 0$ | Cholesky 分解將失敗，程序報錯 |\n| **對稱性** | $\\rho_{ij} = \\rho_{ji}$ | 模型邏輯出現基礎物理衝突 |\n| **相關係數範圍** | $|\\rho| \\le 1$ | 數學上不存在該類資產聯動結構 |\n\n> [!IMPORTANT]\n> 在 **NumPy** 實作中（見 `B2_Ch3_4.py`），使用 `np.linalg.cholesky(matrix)` 是標準做法。若遇到矩陣因估計誤差而非半正定的情況，資深分析師應採用「最近鄰相關矩陣 (Nearist Correlation Matrix)」算法修復後再行分解。\n\n#### 3.5 資深從業人員行動清單 (Action Items)\n執行多資產模擬前，必須落實：\n- **矩陣合法性檢定**：檢測相關性矩陣的行列式與特徵值，確保其具備分解的前提。\n- **誤差回饋測試**：模擬生成後，計算樣本相關係數 $\\hat{\\mathbf{R}}$ 並與目標 $\\mathbf{R}$ 比對，確保誤差在收斂範圍內。\n- **維度匹配審查**：確保 Cholesky 下三角矩陣的維度與隨機向量 $N \\times M$ 的資產數量完全一致。"}